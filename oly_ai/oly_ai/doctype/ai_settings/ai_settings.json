{
 "actions": [],
 "allow_rename": 0,
 "creation": "2026-02-16 00:00:00.000000",
 "doctype": "DocType",
 "engine": "InnoDB",
 "field_order": [
  "provider_section",
  "provider_type",
  "api_key",
  "base_url",
  "column_break_provider",
  "default_model",
  "embedding_model",
  "embedding_base_url",
  "parameters_section",
  "max_tokens",
  "temperature",
  "column_break_params",
  "top_p",
  "timeout_seconds",
  "system_prompt_section",
  "system_prompt",
  "training_section",
  "indexed_doctypes",
  "training_actions",
  "index_stats_html",
  "access_control_section",
  "enable_access_control",
  "access_levels",
  "execution_section",
  "enable_data_queries",
  "enable_execute_mode",
  "require_approval",
  "column_break_exec",
  "dangerous_actions_warning",
  "max_records_per_query",
  "max_tool_rounds",
  "budget_section",
  "monthly_budget_usd",
  "daily_request_limit",
  "rate_limit_per_minute",
  "budget_warning_pct",
  "column_break_budget",
  "current_month_spend",
  "requests_today",
  "cache_section",
  "enable_caching",
  "cache_ttl_hours",
  "branding_section",
  "brand_color_from",
  "brand_color_to",
  "apply_brand_to_header",
  "logging_section",
  "enable_audit_logging",
  "enable_cost_tracking",
  "column_break_logging",
  "log_prompts",
  "log_responses",
  "self_hosted_section",
  "self_hosted_info",
  "customer_service_section",
  "enable_auto_response",
  "auto_response_doctypes",
  "column_break_cs",
  "enable_telegram_ai",
  "telegram_ai_info"
 ],
 "fields": [
  {
   "fieldname": "provider_section",
   "fieldtype": "Section Break",
   "label": "AI Provider"
  },
  {
   "fieldname": "provider_type",
   "fieldtype": "Select",
   "label": "Provider Type",
   "options": "OpenAI\nAnthropic\nCustom (OpenAI Compatible)",
   "default": "OpenAI",
   "reqd": 1,
   "description": "Select 'Custom' for self-hosted (Ollama, vLLM, LiteLLM)"
  },
  {
   "fieldname": "api_key",
   "fieldtype": "Password",
   "label": "API Key",
   "reqd": 1,
   "description": "Your provider API key. For self-hosted without auth, enter any value."
  },
  {
   "fieldname": "base_url",
   "fieldtype": "Data",
   "label": "Base URL",
   "description": "Default: auto-set per provider. For self-hosted: http://your-server:11434/v1",
   "depends_on": "eval:doc.provider_type=='Custom (OpenAI Compatible)'"
  },
  {
   "fieldname": "column_break_provider",
   "fieldtype": "Column Break"
  },
  {
   "fieldname": "default_model",
   "fieldtype": "Data",
   "label": "Default Model",
   "default": "gpt-4o-mini",
   "reqd": 1,
   "description": "e.g. gpt-4o-mini, claude-3-5-sonnet-20241022, llama3.1"
  },
  {
   "fieldname": "embedding_model",
   "fieldtype": "Data",
   "label": "Embedding Model",
   "default": "text-embedding-3-small",
   "description": "For RAG / Ask ERP. Leave blank to disable embeddings."
  },
  {
   "fieldname": "embedding_base_url",
   "fieldtype": "Data",
   "label": "Embedding Base URL",
   "description": "If different from main provider. For self-hosted embeddings."
  },
  {
   "fieldname": "parameters_section",
   "fieldtype": "Section Break",
   "label": "Model Parameters"
  },
  {
   "fieldname": "max_tokens",
   "fieldtype": "Int",
   "label": "Max Tokens per Request",
   "default": 2048,
   "description": "Maximum output tokens per AI call"
  },
  {
   "fieldname": "temperature",
   "fieldtype": "Float",
   "label": "Temperature",
   "default": 0.3,
   "description": "0 = deterministic, 1 = creative. 0.3 recommended for ERP tasks."
  },
  {
   "fieldname": "column_break_params",
   "fieldtype": "Column Break"
  },
  {
   "fieldname": "top_p",
   "fieldtype": "Float",
   "label": "Top P",
   "default": 1.0
  },
  {
   "fieldname": "timeout_seconds",
   "fieldtype": "Int",
   "label": "Timeout (seconds)",
   "default": 30,
   "description": "Max wait time for AI response"
  },
  {
   "fieldname": "system_prompt_section",
   "fieldtype": "Section Break",
   "label": "Global System Prompt"
  },
  {
   "fieldname": "system_prompt",
   "fieldtype": "Code",
   "label": "System Prompt",
   "options": "Markdown",
   "description": "Global AI instructions applied to all requests. AI Prompt Templates can override this for specific features."
  },
  {
   "fieldname": "training_section",
   "fieldtype": "Section Break",
   "label": "Train AI \u2014 Document Indexing"
  },
  {
   "fieldname": "indexed_doctypes",
   "fieldtype": "Table",
   "label": "DocTypes to Index",
   "options": "AI Indexed DocType",
   "description": "Select which DocTypes the AI should learn from. Enable Auto-Index to keep knowledge up-to-date automatically."
  },
  {
   "fieldname": "training_actions",
   "fieldtype": "HTML",
   "label": "Training Actions",
   "options": "<div id='ai-training-actions'></div>"
  },
  {
   "fieldname": "index_stats_html",
   "fieldtype": "HTML",
   "label": "Index Statistics",
   "options": "<div id='ai-index-stats'></div>"
  },
  {
   "fieldname": "access_control_section",
   "fieldtype": "Section Break",
   "label": "Access Control"
  },
  {
   "default": "0",
   "fieldname": "enable_access_control",
   "fieldtype": "Check",
   "label": "Enable Role-Based Access Control",
   "description": "When enabled, AI features are restricted based on user roles. When disabled, all users get full access."
  },
  {
   "fieldname": "access_levels",
   "fieldtype": "Table",
   "label": "Access Levels by Role",
   "options": "AI Access Level",
   "depends_on": "eval:doc.enable_access_control",
   "description": "Map Frappe roles to AI access tiers. Users inherit the highest tier from their roles."
  },
  {
   "fieldname": "execution_section",
   "fieldtype": "Section Break",
   "label": "Execution & Data Access"
  },
  {
   "default": "1",
   "fieldname": "enable_data_queries",
   "fieldtype": "Check",
   "label": "Enable Live Data Queries",
   "description": "Allow AI to search and read ERPNext data (respects user permissions)"
  },
  {
   "default": "0",
   "fieldname": "enable_execute_mode",
   "fieldtype": "Check",
   "label": "Enable Execute Mode",
   "description": "Allow AI to propose document creation/updates (requires approval)"
  },
  {
   "default": "1",
   "fieldname": "require_approval",
   "fieldtype": "Check",
   "label": "Require Approval Before Execution",
   "description": "When enabled, all AI actions must be explicitly approved by the user before execution",
   "depends_on": "eval:doc.enable_execute_mode"
  },
  {
   "fieldname": "column_break_exec",
   "fieldtype": "Column Break"
  },
  {
   "default": "1",
   "fieldname": "dangerous_actions_warning",
   "fieldtype": "Check",
   "label": "Warn on Dangerous Actions",
   "description": "Show extra warnings for Submit, Cancel, Delete operations"
  },
  {
   "default": "100",
   "fieldname": "max_records_per_query",
   "fieldtype": "Int",
   "label": "Max Records per Query",
   "description": "Maximum number of records the AI can fetch in a single query"
  },
  {
   "default": "10",
   "fieldname": "max_tool_rounds",
   "fieldtype": "Int",
   "label": "Max Tool Rounds per Request",
   "description": "Maximum number of tool-call rounds the AI can perform per request (1-25). Higher = more thorough but slower."
  },
  {
   "fieldname": "budget_section",
   "fieldtype": "Section Break",
   "label": "Budget & Rate Limits"
  },
  {
   "fieldname": "monthly_budget_usd",
   "fieldtype": "Currency",
   "label": "Monthly Budget Cap (USD)",
   "default": 100,
   "description": "AI calls stop when this is reached. 0 = unlimited."
  },
  {
   "fieldname": "daily_request_limit",
   "fieldtype": "Int",
   "label": "Daily Request Limit per User",
   "default": 100,
   "description": "Max AI requests per user per day. 0 = unlimited."
  },
  {
   "fieldname": "rate_limit_per_minute",
   "fieldtype": "Int",
   "label": "Rate Limit per Minute",
   "default": 0,
   "description": "Max AI requests per user per minute (sliding window). 0 = disabled."
  },
  {
   "default": "80",
   "fieldname": "budget_warning_pct",
   "fieldtype": "Int",
   "label": "Budget Warning Threshold (%)",
   "description": "Send notification to admins when monthly spend reaches this % of budget. 0 = disabled."
  },
  {
   "fieldname": "column_break_budget",
   "fieldtype": "Column Break"
  },
  {
   "fieldname": "current_month_spend",
   "fieldtype": "Currency",
   "label": "Current Month Spend (USD)",
   "read_only": 1,
   "description": "Auto-calculated from usage"
  },
  {
   "fieldname": "requests_today",
   "fieldtype": "Int",
   "label": "Total Requests Today",
   "read_only": 1
  },
  {
   "fieldname": "cache_section",
   "fieldtype": "Section Break",
   "label": "Caching"
  },
  {
   "fieldname": "enable_caching",
   "fieldtype": "Check",
   "label": "Enable Response Caching",
   "default": 1,
   "description": "Cache identical requests to reduce API costs by 60-80%"
  },
  {
   "fieldname": "cache_ttl_hours",
   "fieldtype": "Int",
   "label": "Cache TTL (hours)",
   "default": 4,
   "description": "How long to cache responses. 0 = indefinite.",
   "depends_on": "eval:doc.enable_caching"
  },
  {
   "fieldname": "logging_section",
   "fieldtype": "Section Break",
   "label": "Logging & Audit"
  },
  {
   "fieldname": "enable_audit_logging",
   "fieldtype": "Check",
   "label": "Enable Audit Logging",
   "default": 1,
   "description": "Log every AI call to AI Audit Log"
  },
  {
   "fieldname": "enable_cost_tracking",
   "fieldtype": "Check",
   "label": "Enable Cost Tracking",
   "default": 1,
   "description": "Track token usage and estimated costs"
  },
  {
   "fieldname": "column_break_logging",
   "fieldtype": "Column Break"
  },
  {
   "fieldname": "log_prompts",
   "fieldtype": "Check",
   "label": "Log Prompts",
   "default": 0,
   "description": "Store full prompts in audit log (may contain sensitive data)"
  },
  {
   "fieldname": "log_responses",
   "fieldtype": "Check",
   "label": "Log Responses",
   "default": 1,
   "description": "Store AI responses in audit log"
  },
  {
   "fieldname": "branding_section",
   "fieldtype": "Section Break",
   "label": "AI Branding",
   "collapsible": 1,
   "description": "Customize the AI assistant look and feel"
  },
  {
   "fieldname": "brand_color_from",
   "fieldtype": "Color",
   "label": "Brand Gradient Start",
   "default": "#f97316",
   "description": "Start color of the AI icon gradient (e.g. #f97316 for orange)"
  },
  {
   "fieldname": "brand_color_to",
   "fieldtype": "Color",
   "label": "Brand Gradient End",
   "default": "#ea580c",
   "description": "End color of the AI icon gradient (e.g. #ea580c for dark orange)"
  },
  {
   "default": "1",
   "fieldname": "apply_brand_to_header",
   "fieldtype": "Check",
   "label": "Apply Brand Color to AI Assistant Header",
   "description": "When enabled, the AI Assistant dialog header uses the brand gradient background instead of the default theme color."
  },
  {
   "fieldname": "self_hosted_section",
   "fieldtype": "Section Break",
   "label": "Self-Hosted / Future Setup",
   "collapsible": 1
  },
  {
   "fieldname": "self_hosted_info",
   "fieldtype": "HTML",
   "label": "Self-Hosted Info",
   "options": "<div class='alert alert-info'><b>To switch to self-hosted AI:</b><ol><li>Set Provider Type to 'Custom (OpenAI Compatible)'</li><li>Set Base URL to your Ollama/vLLM endpoint (e.g. http://your-server:11434/v1)</li><li>Set the model name (e.g. llama3.1)</li><li>Set API Key to any value (or your server's auth token)</li></ol><p>No code changes needed. All features work the same.</p></div>"
  },
  {
   "fieldname": "customer_service_section",
   "fieldtype": "Section Break",
   "label": "Customer Service AI"
  },
  {
   "default": "0",
   "fieldname": "enable_auto_response",
   "fieldtype": "Check",
   "label": "Enable Email Auto-Response Drafts",
   "description": "When enabled, incoming emails on Issues, Leads, etc. get AI-drafted reply suggestions posted as comments."
  },
  {
   "fieldname": "auto_response_doctypes",
   "fieldtype": "Table",
   "label": "Auto-Response DocTypes",
   "options": "AI Indexed DocType",
   "depends_on": "eval:doc.enable_auto_response",
   "description": "Which DocTypes should trigger email auto-response drafts. Leave empty for defaults (Issue, Lead, Opportunity, etc.)"
  },
  {
   "fieldname": "column_break_cs",
   "fieldtype": "Column Break"
  },
  {
   "default": "1",
   "fieldname": "enable_telegram_ai",
   "fieldtype": "Check",
   "label": "Enable Telegram AI Responses",
   "description": "When enabled, incoming Telegram messages in bot-handled chats get automatic AI responses via the Oly Telegram Hub."
  },
  {
   "fieldname": "telegram_ai_info",
   "fieldtype": "HTML",
   "label": "Telegram AI Info",
   "options": "<div class='alert alert-info'><b>Telegram AI:</b> When a chat has <i>Bot Handling</i> enabled (default for new chats), the AI will automatically respond to incoming messages. Once an agent is assigned, AI stops responding to that chat. Requires the Oly app's Telegram Hub to be configured.</div>",
   "depends_on": "eval:doc.enable_telegram_ai"
  }
 ],
 "index_web_pages_for_search": 0,
 "issingle": 1,
 "links": [],
 "modified": "2026-02-18 00:00:00.000000",
 "modified_by": "Administrator",
 "module": "Oly AI",
 "name": "AI Settings",
 "owner": "Administrator",
 "permissions": [
  {
   "create": 1,
   "delete": 0,
   "email": 0,
   "print": 0,
   "read": 1,
   "role": "System Manager",
   "share": 0,
   "write": 1
  }
 ],
 "sort_field": "modified",
 "sort_order": "DESC",
 "track_changes": 1
}
